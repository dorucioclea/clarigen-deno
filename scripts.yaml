scripts:
  clarigen:
    - cmd: vr main

  clarigen-watch:
    cmd: vr main
    watch: ./contracts/*.clar

  deployments:
    cmd: src/cli/gen-deployments.ts
    allow:
      - read
      - write

  test: deno test test_pkg

  type-stubs:
    cmd:
      - scripts/generate-type-stubs.ts
      - deno fmt src/cli/type-stub.ts
    allow:
      - read
      - write

  copy-version:
    cmd:
      - scripts/copy-version.ts
      - deno fmt src/cli/version.ts
    allow:
      - read
      - write

  check:
    pll:
      - deno check src/index.ts
      - deno check src/cli/commands/clarigen.ts
      - deno check test_pkg/*
      - deno lint

  build:
    cmd:
      - vr check
      - vr copy-version
      - vr type-stubs
      - vr clarigen

  release:
    - sh scripts/check-git.sh
    - echo "not dirty" # todo

  test-all:
    pll:
      - deno test test_pkg
      - clarinet test

  main:
    cmd: src/cli/clarigen.ts
    allow:
      - all

  lock: deno cache --lock=lock.json --lock-write src/deps.ts
